try {
    const gamesList = document.getElementById("gamesList");
    console.log("Found games list element:", gamesList);

    // Wait for UV config
    await new Promise(resolve => {
        if (window.__uv$config) {
            resolve();
        } else {
            const checkUV = setInterval(() => {
                if (window.__uv$config) {
                    clearInterval(checkUV);
                    resolve();
                }
            }, 100);
        }
    });

    console.log("UV config loaded:", window.__uv$config);

    // Import games
    const { gamesData } = await import("/assets/json/games.js");
    const { games2Data } = await import("/assets/json/games2.js");
    
    const games = [...gamesData, ...games2Data];

    function loadGame(game) {
        const gameElement = document.createElement("div");
        gameElement.className = "game";
        
        // Create container for image and overlay
        const imageContainer = document.createElement("div");
        imageContainer.style.position = "relative";
        imageContainer.style.width = "16vw";
        imageContainer.style.height = "16vw";
        imageContainer.style.borderRadius = "2rem";
        imageContainer.style.overflow = "hidden";

        const imgElement = document.createElement("img");
        imgElement.src = game.imgSrc;
        imgElement.alt = game.title;
        imgElement.className = "game-image";
        imgElement.style.margin = "0";
        imgElement.style.position = "absolute";
        imgElement.style.top = "0";
        imgElement.style.left = "0";
        imgElement.style.width = "100%";
        imgElement.style.height = "100%";

        // Create overlay that appears on hover
        const overlay = document.createElement("div");
        overlay.style.position = "absolute";
        overlay.style.top = "0";
        overlay.style.left = "0";
        overlay.style.width = "100%";
        overlay.style.height = "100%";
        overlay.style.backgroundColor = "rgba(0, 0, 0, 0.7)";
        overlay.style.opacity = "0";
        overlay.style.transition = "opacity 0.3s ease-in-out";
        overlay.style.display = "flex";
        overlay.style.flexDirection = "column";
        overlay.style.justifyContent = "center";
        overlay.style.alignItems = "center";
        overlay.style.cursor = "pointer";

        const titleElement = document.createElement("h2");
        titleElement.className = "game-title";
        titleElement.textContent = game.title;
        titleElement.style.color = "#fff";
        titleElement.style.margin = "0 0 10px 0";
        titleElement.style.padding = "0 10px";
        titleElement.style.textAlign = "center";

        const playButton = document.createElement("button");
        playButton.className = "play-button";
        playButton.textContent = "Play Now";
        playButton.style.border = "none";
        playButton.style.cursor = "pointer";

        overlay.appendChild(titleElement);
        overlay.appendChild(playButton);

        // Add hover effects
        imageContainer.onmouseover = () => {
            overlay.style.opacity = "1";
        };
        imageContainer.onmouseout = () => {
            overlay.style.opacity = "0";
        };

        // Add click handler
        imageContainer.onclick = (e) => {
            e.stopPropagation();
            localStorage.setItem("loadedG", game.link);
            location.href = "/Classes.html";
        };

        imageContainer.appendChild(imgElement);
        imageContainer.appendChild(overlay);
        gameElement.appendChild(imageContainer);
        gamesList.appendChild(gameElement);
    }

    // Load all games initially
    console.log("Starting to load games...");
    if (Array.isArray(games)) {
        games.forEach(game => {
            loadGame(game);
        });
    } else {
        console.error("Games is not an array:", games);
        gamesList.innerHTML = '<div style="color: white;">Error: Games data is not in the correct format</div>';
    }

    // Setup search functionality
    document.getElementById("searchGames").addEventListener("keyup", function (e) {
        gamesList.innerHTML = '';
        const searchTerm = this.value.toLowerCase();
        for (const game of games) {
            if (game.title.toLowerCase().includes(searchTerm)) {
                loadGame(game);
            }
        }
    });

    document.getElementById("randomGameBtn").addEventListener("click", function() {
        const randomGame = games[Math.floor(Math.random() * games.length)];
        localStorage.setItem("loadedG", randomGame.link);
        location.href = "/Classes.html";
    });

} catch (error) {
    console.error("Error loading games:", error);
    document.getElementById("gamesList").innerHTML = `<div style="color: white;">Error loading games: ${error.message}</div>`;
}
